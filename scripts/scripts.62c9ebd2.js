"use strict";angular.module("photomapApp",["ngRoute","ngTouch","ngStorage","afOAuth2","uiGmapgoogle-maps","cgBusy"]).config(["$routeProvider","uiGmapGoogleMapApiProvider",function(a,b){b.configure({v:"3.17",libraries:"weather,geometry,visualization"}),a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",requireToken:!0}).when("/album/:userid-:albumid",{templateUrl:"views/album.html",controller:"AlbumCtrl",requireToken:!0}).otherwise({redirectTo:"/"})}]),angular.module("photomapApp").controller("MainCtrl",["$scope","AccessToken","$http","uiGmapGoogleMapApi","$rootScope",function(a,b,c,d,e){a.isLogin=null!=b.get(),e.album=null,a.isLogin&&(a.myPromise=c.jsonp("https://picasaweb.google.com/data/feed/api/user/default",{params:{callback:"JSON_CALLBACK",alt:"json-in-script",access_token:b.get().access_token}}).success(function(b){a.albums=b.feed.entry}))}]),angular.module("photomapApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("photomapApp").controller("AlbumCtrl",["$scope","AccessToken","$http","uiGmapGoogleMapApi","$rootScope","$routeParams",function(a,b,c,d,e,f){a.photos=[],d.then(function(){a.map={center:{latitude:59,longitude:18},zoom:8},a.myPromise=c.jsonp("https://picasaweb.google.com/data/feed/api/user/"+f.userid+"/albumid/"+f.albumid,{params:{callback:"JSON_CALLBACK",alt:"json-in-script",access_token:b.get().access_token}}).success(function(b){for(var c in b.feed.entry){var d=b.feed.entry[c];if(d.georss$where){var f=d.georss$where.gml$Point.gml$pos.$t.split(" ");try{a.photos.push({id:d.gphoto$id.$t,latitude:parseFloat(f[0]),longitude:parseFloat(f[1]),content:{title:d.title.$t,time:d.exif$tags.exif$time.$t,image:d.content.src}})}catch(g){console.log(d.gphoto$id.$t+" failed with "+g)}}}e.album={title:b.feed.title.$t,count:a.photos.length}})}),a.windowOptions={show:!1},a.onClick=function(b){a.windowOptions.show=!0,a.windowOptions.coords={latitude:b.model.latitude,longitude:b.model.longitude},a.windowOptions.content=b.model.content,console.log(a.windowOptions.content),console.log(b)},a.closeClick=function(){a.windowOptions.show=!1}}]);